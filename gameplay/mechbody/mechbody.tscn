[gd_scene load_steps=23 format=3 uid="uid://dsh7i4eks64gc"]

[ext_resource type="Script" path="res://gameplay/mechbody/mechbody.gd" id="1_ifmva"]
[ext_resource type="PackedScene" uid="uid://11c031wphmm0" path="res://cockpit_test/cockpit.tscn" id="2_gumoi"]
[ext_resource type="PackedScene" uid="uid://cjemm0ivcuagh" path="res://gameplay/mechbody/arm_targeter.tscn" id="2_nvite"]
[ext_resource type="PackedScene" uid="uid://bln8cdsrflypy" path="res://gameplay/mechbody/flight_module.tscn" id="4_wgapf"]
[ext_resource type="ArrayMesh" uid="uid://bsrxmndxpa0gm" path="res://assets/gunmech_actual.obj" id="5_3oo3b"]
[ext_resource type="PackedScene" uid="uid://doptv24orlqm0" path="res://cockpit_test/mech_hand.tscn" id="5_68b7c"]
[ext_resource type="PackedScene" uid="uid://1t2q4b1xyydv" path="res://gameplay/cockpit_console/virtual/vhud_button_test.tscn" id="5_gxs6w"]
[ext_resource type="PackedScene" uid="uid://dvg5e6hisacwi" path="res://mechbody_controller.tscn" id="6_gk30v"]
[ext_resource type="Material" uid="uid://cr3o3nwa7xg1b" path="res://materials/generic_toon.tres" id="6_kxm6c"]
[ext_resource type="PackedScene" uid="uid://bak1wwgkoec2" path="res://gameplay/mechtools/beamfx2.tscn" id="6_nmrqg"]
[ext_resource type="PackedScene" uid="uid://bydqfltfgashh" path="res://gameplay/mechbody/mech_hand_tool_manager.tscn" id="9_fsaan"]
[ext_resource type="PackedScene" uid="uid://b6po2ax5njo4o" path="res://gameplay/mechtools/basic_mech_gun.tscn" id="9_srk0d"]
[ext_resource type="PackedScene" uid="uid://cwn381pjcowiv" path="res://effects/wind_particles.tscn" id="9_t76ck"]
[ext_resource type="PackedScene" uid="uid://dfsksqu0ew2gv" path="res://gameplay/mechbody/pull_thruster.tscn" id="11_lhcv4"]
[ext_resource type="PackedScene" uid="uid://cnlpm1f8k8x7h" path="res://gameplay/mechtools/shield.tscn" id="12_aybva"]
[ext_resource type="PackedScene" uid="uid://ct1mqoq7ffeph" path="res://gameplay/controls/flight_module_panel.tscn" id="12_ut7dy"]
[ext_resource type="PackedScene" uid="uid://dblov20n4ihk2" path="res://cockpit_test/arm_base.tscn" id="13_8cwlu"]

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_pfxel"]
friction = 0.53
absorbent = true

[sub_resource type="CylinderMesh" id="CylinderMesh_4co0s"]
top_radius = 1.0
bottom_radius = 1.0
height = 1.0

[sub_resource type="BoxMesh" id="BoxMesh_mniyf"]
size = Vector3(0.1, 0.15, 0.2)

[sub_resource type="BoxMesh" id="BoxMesh_nxfr1"]
size = Vector3(5, 5, 5)

[sub_resource type="CylinderShape3D" id="CylinderShape3D_g8pff"]
height = 1.568
radius = 2.0

[node name="Mechbody" type="RigidBody3D" node_paths=PackedStringArray("cockpit", "left_arm_targeter", "right_arm_targeter", "step_push_timer", "step_fall_timer")]
mass = 100.0
physics_material_override = SubResource("PhysicsMaterial_pfxel")
gravity_scale = 0.0
max_contacts_reported = 2
contact_monitor = true
linear_damp = 0.1
angular_damp = 2.0
script = ExtResource("1_ifmva")
step_power = 200000.0
cockpit = NodePath("Cockpit")
left_arm_targeter = NodePath("ArmTargeterLeft")
right_arm_targeter = NodePath("ArmTargeterRight")
step_push_timer = NodePath("Step/StepPushTimer")
step_fall_timer = NodePath("Step/StepFallTimer")

[node name="MechbodyController" parent="." node_paths=PackedStringArray("body", "flight_controller_pitch", "flight_controller_yaw", "pull_thruster", "arm_aimer_hand_remote", "cockpit_headset_reference") instance=ExtResource("6_gk30v")]
body = NodePath("..")
flight_controller_pitch = NodePath("../FlightModule")
flight_controller_yaw = NodePath("../FlightModuleTail")
pull_thruster = NodePath("../LeftHandRemote/PullThruster")
arm_aimer_hand_remote = NodePath("../LeftHandRemote")
cockpit_headset_reference = NodePath("../Cockpit/PlayerBodyReferences/HeadsetReference")

[node name="MeshInstance3D" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.832651, 0)
visible = false
mesh = SubResource("CylinderMesh_4co0s")

[node name="ArmTargeterLeft" parent="." node_paths=PackedStringArray("player_shoulder", "player_yoke", "arm") instance=ExtResource("2_nvite")]
scaling = 16
player_shoulder = NodePath("../Cockpit/PlayerBodyReferences/PlayerShoulderLeft")
player_yoke = NodePath("../Cockpit/Handles/YokeGrabbableLeft")
arm = NodePath("../ArmBaseLeft")

[node name="ArmTargeterRight" parent="." node_paths=PackedStringArray("player_shoulder", "player_yoke", "arm") instance=ExtResource("2_nvite")]
scaling = 16
player_shoulder = NodePath("../Cockpit/PlayerBodyReferences/PlayerShoulderRight")
player_yoke = NodePath("../Cockpit/Handles/YokeGrabbableRight")
arm = NodePath("../ArmBaseRight")

[node name="Cockpit" parent="." instance=ExtResource("2_gumoi")]

[node name="CockpitAmbience" parent="Cockpit" index="4" node_paths=PackedStringArray("velocity_body")]
stream_paused = false
velocity_body = NodePath("../..")

[node name="VHUDButtonGrabbable2" parent="Cockpit" node_paths=PackedStringArray("tool_manager") instance=ExtResource("5_gxs6w")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.149, 1, -0.214)
tool_manager = NodePath("../../RightHandRemote/MechHandToolManager")

[node name="VHUDButtonGrabbable3" parent="Cockpit" node_paths=PackedStringArray("tool_manager") instance=ExtResource("5_gxs6w")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.149, 1, -0.214)
tool_manager = NodePath("../../LeftHandRemote/MechHandToolManager")

[node name="ArmBaseLeft" parent="." instance=ExtResource("13_8cwlu")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, -2.05972, 0.169736, 0.577723)

[node name="ArmBaseRight" parent="." instance=ExtResource("13_8cwlu")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 1.94028, 0.169736, 0.577723)

[node name="LeftHandRemote" parent="." node_paths=PackedStringArray("current_tool", "arm") instance=ExtResource("5_68b7c")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, -2, 0.946095, -3.58666)
current_tool = NodePath("beamfx2")
arm = NodePath("../ArmBaseLeft")

[node name="MechHandToolManager" parent="LeftHandRemote" node_paths=PackedStringArray("tools", "input_grabbable") instance=ExtResource("9_fsaan")]
tools = [NodePath("../beamfx2"), NodePath("../BasicGun"), NodePath("../Shield")]
input_grabbable = NodePath("../../Cockpit/Handles/YokeGrabbableLeft")

[node name="PullThruster" parent="LeftHandRemote" instance=ExtResource("11_lhcv4")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 12, 0, 0)
thrust = 400

[node name="beamfx2" parent="LeftHandRemote" instance=ExtResource("6_nmrqg")]
transform = Transform3D(3, 4.26326e-14, 3.81165e-20, -2.51965e-14, 1.77304, 2.41998, 3.439e-14, -2.41998, 1.77304, 9.53674e-07, -4.17233e-07, -0.665171)

[node name="BasicGun" parent="LeftHandRemote" node_paths=PackedStringArray("launching_rigidbody") instance=ExtResource("9_srk0d")]
trigger_action = "trigger_click"
launching_rigidbody = NodePath("../..")

[node name="Shield" parent="LeftHandRemote" instance=ExtResource("12_aybva")]
transform = Transform3D(1.38021, -0.783165, -3.42332e-08, 0, -8.74228e-08, 2, -0.587374, -1.84029, -8.04415e-08, 0, 0, -0.701411)
tool_name = "SHIELD"

[node name="RightHandRemote" parent="." node_paths=PackedStringArray("arm") instance=ExtResource("5_68b7c")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 2.01847, 0.2794, -2.90604)
arm = NodePath("../ArmBaseRight")

[node name="MechHandToolManager" parent="RightHandRemote" node_paths=PackedStringArray("tools", "input_grabbable") instance=ExtResource("9_fsaan")]
tools = [NodePath("../BasicGun"), NodePath("../beamfx")]
input_grabbable = NodePath("../../Cockpit/Handles/YokeGrabbableRight")

[node name="BasicGun" parent="RightHandRemote" node_paths=PackedStringArray("launching_rigidbody") instance=ExtResource("9_srk0d")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.16523, -3.00979)
trigger_action = "trigger_click"
launching_rigidbody = NodePath("../..")

[node name="beamfx" parent="RightHandRemote" instance=ExtResource("6_nmrqg")]
transform = Transform3D(3, 0, 0, 0, 1.73272, 2.44902, 0, -2.44902, 1.73272, 0, 0, -0.951247)

[node name="FlightModule" parent="." node_paths=PackedStringArray("mechbody") instance=ExtResource("4_wgapf")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0422812, 0.942789, -1.45214)
mechbody = NodePath("..")
coefficient = 4.0

[node name="MeshInstance3D2" type="MeshInstance3D" parent="FlightModule"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.214992)
visible = false
mesh = SubResource("BoxMesh_mniyf")
skeleton = NodePath("../..")

[node name="FlightPanel" parent="FlightModule" node_paths=PackedStringArray("flight_module") instance=ExtResource("12_ut7dy")]
transform = Transform3D(0.244102, 0, 0, 0, 0.231611, -0.673907, 0, 0.0770828, 2.02489, -0.0845021, 0.483912, 1.29092)
flight_module = NodePath("..")

[node name="FlightModuleTail" parent="." node_paths=PackedStringArray("mechbody") instance=ExtResource("4_wgapf")]
transform = Transform3D(-4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0, 1, -0.0422812, 0.0477576, 0.0106616)
mechbody = NodePath("..")
coefficient = 4.0

[node name="FlightPanel" parent="FlightModuleTail" instance=ExtResource("12_ut7dy")]
transform = Transform3D(0.244102, 0, 0, 0, 0.243389, 0.162944, 0, -0.0186379, 2.12786, 1.13703, -0.395037, -0.124847)

[node name="WindParticles" parent="." node_paths=PackedStringArray("body") instance=ExtResource("9_t76ck")]
body = NodePath("..")

[node name="MeshInstance3D3" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.563671, 1.02496)
visible = false
mesh = SubResource("BoxMesh_nxfr1")
skeleton = NodePath("../MeshInstance3D2")

[node name="MeshInstance3D2" type="MeshInstance3D" parent="."]
transform = Transform3D(0.05, 0, 0, 0, 0.05, 0, 0, 0, 0.05, 0, -0.814902, 4.54445)
mesh = ExtResource("5_3oo3b")
surface_material_override/0 = ExtResource("6_kxm6c")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.38919, 0.996926)
shape = SubResource("CylinderShape3D_g8pff")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -4.22045, 0.996926)
shape = SubResource("CylinderShape3D_g8pff")

[node name="Step" type="Node3D" parent="."]

[node name="StepPushTimer" type="Timer" parent="Step"]
one_shot = true

[node name="StepFallTimer" type="Timer" parent="Step"]

[connection signal="body_entered" from="." to="." method="_on_body_entered"]
[connection signal="body_exited" from="." to="." method="_on_body_exited"]
[connection signal="timeout" from="Step/StepPushTimer" to="." method="_on_step_push_timer_timeout"]
[connection signal="timeout" from="Step/StepFallTimer" to="." method="_on_step_fall_timer_timeout"]

[editable path="Cockpit"]
